#input name of station, print all lines that pass through
#input tube line name and print all stations on input
import pandas  as pd
import json
import mysql.connector as mysql

## connecting to the database using 'connect()' method
## it takes 3 required parameters 'host', 'user', 'passwd'
db = mysql.connect(
    host = "localhost",
    user = "root",
    passwd = "dbms"
)

with open("train-network.json") as f:
    data=json.load(f)

df = pd.DataFrame(data)

mysql = MySQLUtil()
mysql.connectDB(host ='localhost', user = 'root', psw = '', db_name = 'test')

cursor = db.cursor()

## creating a table called 'users' in the 'datacamp' database
cursor.execute("CREATE TABLE stations( stationID VARCHAR(255) PRIMARY KEY, name VARCHAR(255), lineName VARCHAR(255) FOREIGN KEY REFERENCES lines(lineName);)")
cursor.execute("CREATE TABLE lines (lineName VARCHAR(255) PRIMARY KEY;")
cursor.execute("CREATE TABLE stationLine(stationLineID VARCHAR(255), stationId FOREIGN KEY REFERENCES stations(stationID), lineName FOREIGN KEY REFERENCES lines(lineName); ")